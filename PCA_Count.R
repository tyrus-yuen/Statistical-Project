library(utils)
library(openxlsx)
claimdata<-read.xlsx("2_count_standardize.xlsx")
idpnt<-claimdata[,2:ncol(claimdata)]
(pca_count<-princomp(idpnt, cor = TRUE, scale. = TRUE) )
(vars <- (pca_count$sdev)^2)  # ???pca??????????????????(pca$sdev)?????????????????????variance(?????????)

(props <- vars / sum(vars))

(cumulative.props <- cumsum(props))  # ?????????n???????????????

plot(cumulative.props)
# ??????plot()??????
plot(pca_count,         # ???pca
     type="line", # ????????????????????????
     main="Scree Plot for Count") # ?????????

# ???????????????????????????=1?????????
abline(h=1, col="blue") # Kaiser eigenvalue-greater-than-one rule

